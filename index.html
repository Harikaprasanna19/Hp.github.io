<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>StitchConnect — Prototype</title>
  <style>
    :root{
      --bg:#f7fafc; --card:#ffffff; --accent:#e11d48; --muted:#6b7280;
      --radius:10px; --shadow: 0 6px 18px rgba(17,24,39,0.06);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    html,body{height:100%; margin:0; background:var(--bg); color:#0f172a;}
    .container{max-width:1100px; margin:24px auto; padding:18px;}
    header{display:flex;align-items:center;justify-content:space-between;background:var(--card);padding:14px;border-radius:12px;box-shadow:var(--shadow)}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,#fb7185,#fb923c);display:flex;align-items:center;justify-content:center;color:white;font-weight:700}
    h1{margin:0;font-size:18px}
    .subtitle{font-size:12px;color:var(--muted)}
    .seg{display:inline-flex;background:#fafafa;border-radius:999px;padding:4px}
    .seg button{border:0;background:transparent;padding:8px 12px;border-radius:999px;cursor:pointer;color:var(--muted);font-weight:600}
    .seg button.active{background:#fff;box-shadow:0 4px 10px rgba(2,6,23,0.06);color:var(--accent)}
    main{display:grid;grid-template-columns:2fr 1fr;gap:18px;margin-top:18px}
    .card{background:var(--card);padding:16px;border-radius:var(--radius);box-shadow:var(--shadow)}
    .search{display:flex;gap:8px}
    input[type="text"],textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #e6edf3;font-size:14px}
    button.cta{background:var(--accent);color:white;border:0;padding:8px 12px;border-radius:8px;cursor:pointer}
    .grid{display:grid;grid-template-columns:repeat(1,1fr);gap:12px}
    .tailor-card{display:flex;justify-content:space-between;gap:12px;border:1px solid #eef2f7;padding:12px;border-radius:10px;align-items:center}
    .product-list{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .product{border:1px dashed #e6edf3;padding:8px;border-radius:8px;font-size:13px}
    .profile{display:flex;gap:14px;align-items:center}
    .avatar{width:78px;height:78px;border-radius:10px;background:#f3f4f6;display:flex;align-items:center;justify-content:center;font-weight:700;color:#334155}
    .chat{display:flex;flex-direction:column;height:320px;border:1px solid #eef2f7;border-radius:10px;overflow:hidden}
    .chat .messages{flex:1;padding:10px;overflow:auto;background:linear-gradient(180deg,#fff,#fbfbfb)}
    .msg{display:inline-block;padding:8px 10px;border-radius:10px;margin-bottom:8px;max-width:75%;font-size:14px}
    .msg.them{background:#fff}
    .msg.you{background:#fff0f6;color:#7f1d1d;align-self:flex-end}
    .chat .composer{display:flex;padding:8px;border-top:1px solid #eef2f7;gap:8px}
    label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
    small.muted{font-size:12px;color:var(--muted)}
    .aside-list{display:flex;flex-direction:column;gap:12px}
    .mini{display:flex;justify-content:space-between;gap:8px;align-items:center}
    .provider-form input{margin-bottom:8px}
    .kbd{background:#111827;color:white;padding:6px 8px;border-radius:6px;font-size:13px}
    footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}
    @media(max-width:900px){main{grid-template-columns:1fr} .avatar{width:56px;height:56px}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">S</div>
        <div>
          <h1>StitchConnect</h1>
          <div class="subtitle">Connects local tailors, home designers & boutiques — doorstep stitching</div>
        </div>
      </div>

      <div style="display:flex;align-items:center;gap:12px">
        <div class="seg" role="tablist" aria-label="Mode">
          <button id="modeCustomer" class="active">Customer</button>
          <button id="modeProvider">Provider</button>
        </div>
        <button class="kbd">Sign in</button>
      </div>
    </header>

    <main>
      <!-- Left / main column -->
      <section>
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <h2 style="margin:0">Find a tailor nearby</h2>
              <div class="subtitle" style="margin-top:6px">Search by name, craft or location</div>
            </div>
            <div style="text-align:right">
              <div class="subtitle">Quick action</div>
              <div style="margin-top:8px"><button class="cta" id="quickOrder">Order ₹200 Plain Blouse</button></div>
            </div>
          </div>

          <div style="margin-top:14px" class="search">
            <input id="searchInput" type="text" placeholder="e.g., Harika, silk, embroidery, Connaught Place" />
            <button class="cta" id="searchBtn">Search</button>
          </div>
        </div>

        <div id="listWrap" style="margin-top:12px" class="grid"></div>

        <div id="profileWrap" style="margin-top:12px;display:none" class="card">
          <!-- populated dynamically -->
        </div>
      </section>

      <!-- Right / aside -->
      <aside>
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <strong>How it works</strong>
              <div class="subtitle" style="margin-top:6px">Simple steps for customer & tailor</div>
            </div>
          </div>
          <ol style="margin-top:12px;padding-left:18px;color:var(--muted);font-size:14px;line-height:1.6">
            <li>Find a nearby tailor</li>
            <li>Chat to confirm measurements & price</li>
            <li>Request pickup — provide address</li>
            <li>Tailor stitches and returns finished garment</li>
          </ol>
        </div>

        <div id="providerCard" class="card" style="margin-top:12px;display:none">
          <strong>Provider Quick Panel</strong>
          <div style="margin-top:10px" class="provider-form">
            <label>Tailor name</label>
            <input id="provName" type="text" placeholder="e.g., Harika Designs" />
            <label>Location</label>
            <input id="provLoc" type="text" placeholder="City / Area" />
            <label>Base price - Plain blouse (₹)</label>
            <input id="provPrice" type="number" placeholder="200" />
            <div style="display:flex;gap:8px;margin-top:8px">
              <button class="cta" id="provCreate">Create / Update</button>
              <button id="provLoad" style="padding:8px;border-radius:8px;border:1px solid #eef2f7;background:white">Load My Tailor</button>
            </div>
            <small class="muted">Tip: Use the Provider mode to add products & set price.</small>
          </div>
        </div>

        <div class="card aside-list" style="margin-top:12px">
          <div>
            <strong>Quick stats (mock)</strong>
            <div class="mini"><span class="subtitle">Active tailors</span><strong id="statTailors">0</strong></div>
            <div class="mini"><span class="subtitle">Pending pickups</span><strong id="statPickups">0</strong></div>
          </div>

          <div style="margin-top:10px">
            <strong>Testing shortcuts</strong>
            <div style="margin-top:8px">
              <small class="muted">Try these to explore flows</small>
              <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
                <button id="seedBtn" style="padding:8px;border-radius:8px;border:1px solid #eef2f7;background:white">Seed demo tailors</button>
                <button id="clearBtn" style="padding:8px;border-radius:8px;border:1px solid #fee2e2;color:var(--accent);background:#fff0f2">Reset demo</button>
              </div>
            </div>
          </div>
        </div>

      </aside>
    </main>

    <footer>
      Prototype — demo only. This page stores data locally in your browser (no server).
    </footer>
  </div>

  <script>
    /*******************************
     * StitchConnect — Single-file prototype
     * Save as stitchconnect.html and open in browser.
     ********************************/

    // Mock storage keys
    const KEY_TAILORS = 'sc_tailors_v1';
    const KEY_PICKUPS = 'sc_pickups_v1';

    // Helper: default demo data
    const DEMO = [
      {
        id: 't1',
        name: "Harika Designs",
        location: "Connaught Place, New Delhi",
        pricePlainBlouse: 200,
        rating: 4.7,
        about: "Experienced in bridal & daily wear - quick turnaround.",
        products: [{id:'p1', title:'Plain Cotton Blouse', price:200},{id:'p2', title:'Silk Embroidered Blouse', price:600}]
      },
      {
        id: 't2',
        name: "Seema's Stitch Studio",
        location: "Jodhpur, Rajasthan",
        pricePlainBlouse: 220,
        rating: 4.3,
        about: "Traditional crafts and custom block prints.",
        products: [{id:'p3', title:'Handloom Blouse', price:400}]
      }
    ];

    // Initial load
    function loadTailors(){
      const raw = localStorage.getItem(KEY_TAILORS);
      try {
        return raw ? JSON.parse(raw) : [];
      } catch(e){ return []; }
    }
    function saveTailors(list){ localStorage.setItem(KEY_TAILORS, JSON.stringify(list)); updateStats(); }

    function loadPickups(){ const raw=localStorage.getItem(KEY_PICKUPS); return raw?JSON.parse(raw):[]; }
    function savePickups(list){ localStorage.setItem(KEY_PICKUPS, JSON.stringify(list)); updateStats(); }

    // Render list
    const listWrap = document.getElementById('listWrap');
    const profileWrap = document.getElementById('profileWrap');
    const statTailors = document.getElementById('statTailors');
    const statPickups = document.getElementById('statPickups');

    function renderList(filterText=''){
      const tailors = loadTailors();
      listWrap.innerHTML = '';
      const f = filterText.trim().toLowerCase();
      const filtered = tailors.filter(t => !f || (t.name+t.location+(t.products?.map(p=>p.title).join('')||'')).toLowerCase().includes(f));
      if(filtered.length===0){
        listWrap.innerHTML = '<div class="card">No tailors found. Use "Seed demo tailors" to populate sample data.</div>';
        updateStats(); return;
      }
      filtered.forEach(t => {
        const div = document.createElement('div');
        div.className = 'tailor-card';
        div.innerHTML = `
          <div style="display:flex;gap:12px;align-items:center">
            <div style="width:56px;height:56px;border-radius:8px;background:#fff7f9;display:flex;align-items:center;justify-content:center;font-weight:700;color:#9f1239">${t.name.split(' ').map(s=>s[0]).slice(0,2).join('')}</div>
            <div style="min-width:220px">
              <div style="font-weight:700">${t.name}</div>
              <div class="subtitle">${t.location} • Rating ${t.rating || '—'}</div>
            </div>
            <div style="margin-left:8px">
              <div class="subtitle">From</div>
              <div style="font-weight:700">₹${t.pricePlainBlouse || '-'}</div>
            </div>
          </div>
          <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
            <div class="product-list">${(t.products||[]).map(p=>`<div class="product">${p.title} • ₹${p.price}</div>`).join('')}</div>
            <div style="display:flex;gap:8px;margin-top:6px">
              <button class="btnView" data-id="${t.id}" style="padding:8px;border-radius:8px;border:1px solid #eef2f7;background:white">View & Chat</button>
              <button class="btnOrder" data-id="${t.id}" style="padding:8px;border-radius:8px;background:var(--accent);color:white;border:0">Order</button>
            </div>
          </div>
        `;
        listWrap.appendChild(div);
      });

      // attach listeners
      listWrap.querySelectorAll('.btnView').forEach(b=>b.addEventListener('click', e=>{
        const id = e.currentTarget.dataset.id; openProfile(id);
      }));
      listWrap.querySelectorAll('.btnOrder').forEach(b=>b.addEventListener('click', e=>{
        const id = e.currentTarget.dataset.id; openProfile(id, true);
      }));
      updateStats();
    }

    // Open profile + chat + pickup
    function openProfile(id, openPickup=false){
      const tailors = loadTailors();
      const t = tailors.find(x=>x.id===id); if(!t) return alert('Tailor not found.');
      profileWrap.style.display = 'block';
      profileWrap.innerHTML = `
        <div class="profile">
          <div class="avatar">${t.name.split(' ').map(s=>s[0]).slice(0,2).join('')}</div>
          <div style="flex:1">
            <div style="font-weight:700;font-size:18px">${t.name}</div>
            <div class="subtitle" style="margin-top:6px">${t.about || ''}</div>
            <div style="margin-top:8px" class="subtitle">Location: ${t.location} • Rating: ${t.rating || '—'}</div>
            <div style="margin-top:8px"><strong>From ₹${t.pricePlainBlouse}</strong></div>
            <div style="margin-top:10px" id="productArea"></div>
          </div>
        </div>

        <div style="margin-top:12px;display:flex;gap:12px;flex-wrap:wrap">
          <div style="flex:1;min-width:260px">
            <div style="font-weight:700;margin-bottom:8px">Chat</div>
            <div class="chat" id="chatBox">
              <div class="messages" id="messages"></div>
              <div class="composer">
                <input id="chatInput" type="text" placeholder="Type a message..." />
                <button id="sendBtn" class="cta">Send</button>
              </div>
            </div>
          </div>

          <div style="width:320px;min-width:260px">
            <div style="font-weight:700;margin-bottom:8px">Schedule Pickup</div>
            <div style="border:1px solid #eef2f7;padding:10px;border-radius:8px">
              <label>Name</label><input id="pickupName" type="text" />
              <label>Phone</label><input id="pickupPhone" type="text" />
              <label>Pickup address</label><textarea id="pickupAddress" rows="3"></textarea>
              <label>Notes (measurements / fabric)</label><textarea id="pickupNotes" rows="2"></textarea>
              <div style="margin-top:8px;text-align:right"><button id="pickupBtn" class="cta">Request Pickup</button></div>
            </div>
            <div style="margin-top:10px" id="pickupResult"></div>
          </div>
        </div>
      `;

      // populate products
      const prodArea = document.getElementById('productArea');
      prodArea.innerHTML = (t.products||[]).map(p=>`<div style="display:flex;justify-content:space-between;align-items:center;padding:6px 0;border-bottom:1px dashed #f3f4f6"><div>${p.title}</div><div class="muted">₹${p.price}</div></div>`).join('');

      // init chat
      const messagesEl = document.getElementById('messages');
      messagesEl.innerHTML = `<div class="msg them">Hi, I'm ${t.name.split(' ')[0]}. How can I help?</div>`;
      const chatInput = document.getElementById('chatInput');
      document.getElementById('sendBtn').onclick = ()=>{ const v=chatInput.value.trim(); if(!v) return; messagesEl.innerHTML += `<div class="msg you">${escapeHtml(v)}</div>`; chatInput.value=''; messagesEl.scrollTop = messagesEl.scrollHeight; setTimeout(()=>{ messagesEl.innerHTML += `<div class="msg them">Thanks — I received your message. I'll confirm pickup time.</div>`; messagesEl.scrollTop = messagesEl.scrollHeight; },700) };

      // pickup
      document.getElementById('pickupBtn').onclick = ()=>{
        const name = document.getElementById('pickupName').value.trim();
        const phone = document.getElementById('pickupPhone').value.trim();
        const addr = document.getElementById('pickupAddress').value.trim();
        const notes = document.getElementById('pickupNotes').value.trim();
        if(!name||!phone||!addr) return alert('Please provide name, phone and pickup address.');
        // store pickup
        const pickups = loadPickups();
        pickups.push({id:'pickup_'+Date.now(), tailorId:t.id, name, phone, addr, notes, status:'requested', createdAt:Date.now()});
        savePickups(pickups);
        document.getElementById('pickupResult').innerHTML = `<div style="padding:10px;border-radius:8px;background:#ecfdf5;color:#065f46">Pickup requested. Tailor will contact you via chat.</div>`;
      };

      if(openPickup){
        document.getElementById('pickupName').focus();
      }

      // scroll into view
      profileWrap.scrollIntoView({behavior:'smooth'});
    }

    // Utilities
    function escapeHtml(str){ return str.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

    // Provider mode handlers
    const provCard = document.getElementById('providerCard');
    document.getElementById('provCreate').addEventListener('click', ()=>{
      const name = document.getElementById('provName').value.trim();
      const loc = document.getElementById('provLoc').value.trim();
      const price = Number(document.getElementById('provPrice').value) || 200;
      if(!name||!loc) return alert('Enter name and location');
      let tailors = loadTailors();
      // if exists update
      let t = tailors.find(x=>x.name.toLowerCase()===name.toLowerCase());
      if(t){
        t.location=loc; t.pricePlainBlouse=price;
      } else {
        t = {id:'t_'+Date.now(), name, location:loc, pricePlainBlouse:price, rating:4.5, about:'', products:[]};
        tailors.push(t);
      }
      saveTailors(tailors);
      alert('Provider profile saved locally. Use Load My Tailor to fetch.');
      renderList();
    });

    document.getElementById('provLoad').addEventListener('click', ()=>{
      const name = document.getElementById('provName').value.trim();
      if(!name) return alert('Enter tailor name to load');
      const tailors = loadTailors();
      const t = tailors.find(x=>x.name.toLowerCase()===name.toLowerCase());
      if(!t) return alert('No tailor found with that name.');
      // open profile view but in provider mode (for editing)
      openProfile(t.id);
      // allow adding products by clicking "Order" -> not implemented full; user can use console for demo
    });

    // Mode toggle
    document.getElementById('modeCustomer').addEventListener('click', ()=>setMode('customer'));
    document.getElementById('modeProvider').addEventListener('click', ()=>setMode('provider'));
    function setMode(m){
      document.getElementById('modeCustomer').classList.toggle('active', m==='customer');
      document.getElementById('modeProvider').classList.toggle('active', m==='provider');
      provCard.style.display = m==='provider' ? 'block' : 'none';
      // show/hide some UI depending on mode
    }

    // Search
    document.getElementById('searchBtn').addEventListener('click', ()=>renderList(document.getElementById('searchInput').value));
    document.getElementById('searchInput').addEventListener('keydown', (e)=>{ if(e.key==='Enter') renderList(document.getElementById('searchInput').value); });

    // Seed / Clear
    document.getElementById('seedBtn').addEventListener('click', ()=>{ localStorage.setItem(KEY_TAILORS, JSON.stringify(DEMO)); renderList(); alert('Demo tailors seeded'); });
    document.getElementById('clearBtn').addEventListener('click', ()=>{ localStorage.removeItem(KEY_TAILORS); localStorage.removeItem(KEY_PICKUPS); renderList(); updateStats(); alert('Demo data cleared'); });

    // Quick order button (gives a modal-like flow)
    document.getElementById('quickOrder').addEventListener('click', ()=>{
      const tailors = loadTailors();
      if(!tailors.length) return alert('No tailors available. Seed demo first.');
      // pick nearest mock = first
      openProfile(tailors[0].id, true);
      setTimeout(()=>{ document.getElementById('pickupName').value = 'Quick Customer'; document.getElementById('pickupPhone').value='9999999999'; },100);
    });

    // Stats update
    function updateStats(){
      const tailors = loadTailors(); const pickups = loadPickups();
      statTailors.innerText = tailors.length;
      statPickups.innerText = pickups.filter(p=>p.status==='requested').length;
    }

    // init
    (function init(){
      renderList();
      updateStats();
      setMode('customer');
    })();

  </script>
</body>
</html>
